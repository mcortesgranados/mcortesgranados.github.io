<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ensemble Methods (Random Forest) Example</title>
    <!-- Include necessary CSS or styling if needed -->
    <link href="../estilos.css" rel="stylesheet" type="text/css">
</head>
<body class="texto8_1">

<h1>Ensemble Methods (Random Forest) Example</h1>

<p>This is a simple example of Ensemble Methods using Python and scikit-learn (Random Forest).</p>

<h2>Ensemble Methods Overview</h2>

<p>Ensemble Methods combine the predictions of multiple base models to improve the overall performance and robustness. One popular type of Ensemble Method is the Random Forest, which builds a collection of decision trees and combines their predictions. Each tree is trained on a random subset of the data and features, leading to a diverse set of weak learners that collectively form a strong learner.</p>

<p>Key concepts of Random Forest and Ensemble Methods:</p>

<ul>
    <li><b>Base Models:</b> The individual models (e.g., decision trees) combined in the ensemble.</li>
    <li><b>Bagging (Bootstrap Aggregating):</b> Random subsets of the data are used to train each base model.</li>
    <li><b>Feature Randomization:</b> Random subsets of features are considered for splitting at each node in the decision trees.</li>
    <li><b>Voting or Averaging:</b> The ensemble combines predictions through voting (classification) or averaging (regression).</li>
    <li><b>Ensemble Diversity:</b> The strength of the ensemble often comes from diverse base models.</li>
</ul>

<p>Random Forests are widely used for classification and regression tasks due to their robustness and ability to handle complex relationships in the data.</p>

<p>Python Source Code:</p>

<pre><code># Import necessary libraries
import numpy as np
import matplotlib.pyplot as plt
from sklearn.datasets import make_classification
from sklearn.ensemble import RandomForestClassifier
from sklearn.metrics import accuracy_score, confusion_matrix

# Generate synthetic classification data
np.random.seed(42)
X, y = make_classification(n_samples=1000, n_features=20, n_informative=10, n_clusters_per_class=2, random_state=42)

# Split the data into training and testing sets
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

# Build a Random Forest model
random_forest = RandomForestClassifier(n_estimators=100, random_state=42)
random_forest.fit(X_train, y_train)

# Make predictions on the test set
y_pred = random_forest.predict(X_test)

# Evaluate the model
accuracy = accuracy_score(y_test, y_pred)
conf_matrix = confusion_matrix(y_test, y_pred)

print(f'Accuracy: {accuracy}')
print(f'Confusion Matrix:\n{conf_matrix}')

# Plot feature importances
feature_importances = random_forest.feature_importances_
indices = np.argsort(feature_importances)[::-1]

plt.bar(range(X.shape[1]), feature_importances[indices])
plt.xticks(range(X.shape[1]), indices, rotation=90)
plt.title('Feature Importances')
plt.xlabel('Feature Index')
plt.ylabel('Importance')
plt.show()
</code></pre>

<p>Explanation:</p>

<ul>
    <li><b>Import Libraries:</b> Import necessary Python libraries, including NumPy for numerical operations, Matplotlib for plotting, and scikit-learn for dataset generation and Random Forest.</li>
    <li><b>Generate Synthetic Data:</b> Create synthetic classification data with 20 features using the <code>make_classification</code> function from scikit-learn.</li>
    <li><b>Split Data:</b> Split the data into training and testing sets using the <code>train_test_split</code> function.</li>
    <li><b>Build Model:</b> Create and train a Random Forest classifier using scikit-learn's <code>RandomForestClassifier</code>.</li>
    <li><b>Make Predictions:</b> Use the trained Random Forest model to predict labels for the test set.</li>
    <li><b>Evaluate Model:</b> Calculate accuracy and confusion matrix to evaluate the performance of the model.</li>
    <li><b>Plot Feature Importances:</b> Visualize the importance of each feature in the Random Forest model.</li>
</ul>

<!-- Include necessary JavaScript libraries if needed -->

</body>
</html>
